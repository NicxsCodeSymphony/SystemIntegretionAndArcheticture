<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campus Connect</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="css/page.css">
</head>
<body>
   
    <div class="page-container">
        <div class="page-header">
            <div class="logo"><h3>Campus <span>Connect</span></h3></div>
            <div class="menu">
                <ul>
                    <li><a href="userPage.html">Home</a></li>
                    <li><a href="profile.html">Profile</a></li>
                    <li><a href="friends.html">Find Friends</a></li>
                    <li style="cursor: pointer;" id="notification">Notification</li>
                    <li></li>
                </ul>
            </div>
            <div class="name"><h3 id="name"></h3><button style="margin-left: 10px;" id="logout">Logout</button></div>
        </div>

        <div class="content">
            <div></div>
            
            <div class="feeds">
                <div class="post">
                    <div class="post-heading"><img src="" alt=""> <h4>What's on your mind, <span id="anotherName"></span>?</h4></div>
                    <hr>
                    <div class="post-footer"><i class="fa-regular fa-image"></i><p>Photo</p></div>
                </div>

                <div class="feeds-content">
                    
                </div>

            </div>
            <div class="friend-section"></div>
        </div>

    </div>

    <template class="friendList">
        <div class="friends">
            <h4 class="friendsName"></h4>
        </div>
    </template>

    <div class="add-post">
        <div class="post-heading">
            <h1>Create Post</h1>
            <button id="close">X</button>
        </div>
        <div class="post-images">
            <img class="avatar" src="assets/nico.jpg" alt="">
            <div class="poster-infos">
                <p class="usernames"></p>
                <p class="poster-names"></p>
            </div><br>
        </div>
        <form enctype="multipart/form-data">
        <div class="input-post">
            <textarea id="get-text" placeholder="What's on your mind?"></textarea>
        </div>
        <div class="additional-post">
            <h3>Add to your post</h3>
            <input type="file" name="postImage" id="postImage">
        </div>

       <div class="post-btn-container">
        <button type="button" id="create-post">Create Post</button>
       </div>
    </form>
    </div>

    <div style="height: 100vh; width: 100%; position: fixed; top: 0; background: #fff; display: none" class="modal" id="notificationModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="notification"></div>
        </div>
    </div>
    

    <template class="poster-template">
        <div class="post-container">
            <input type="hidden" id="userId">
            <input type="hidden" id="postId">
            <div class="poster-image">
                <img class="avatar" src="" alt="">
                <div class="poster-info">
                    <p class="username"></p>
                    <p class="poster-name"><span class=""></span></p>
                </div>
            </div>
            <div class="caption"><p class="display-caption"></p></div>
            <div class="post-image"></div>
            <div class="interaction"><i class="fa-regular fa-heart"></i><i class="fa-regular fa-comment open-comment-modal"></i>
            </i></div>
            <hr>
            <div class="comment">
                <!-- <img style="width: 10%; height: 50%; border-radius: 50%;" id="commentAvatar"  src="" alt=""> -->
                <input type="text" name="" id="" placeholder="Write your comment . . ."/>
                <button id="comment-btn">Send</button>
            </div>
        </div>
    </template>

    <div style="height: 100vh; width: 100%; position: fixed; top: 0; background: #fff; display: none" class="modal" id="commentModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="comments-container"></div>
        </div>
    </div>
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.js"></script>
    <script src="js/main.js"></script>
    <script src="js/comments.js"></script>
    <script src="js/friendRequest.js"></script>


    <script>
        
$(document).ready(function() {
    var id = localStorage.getItem("id");
    var name = localStorage.getItem("name");
    var username = localStorage.getItem('username');
    var image = localStorage.getItem('image');
    if (!name) {    
        window.location.href = "index.html"; 
    } else {
        var firstName = name.split(" ").slice(0, -1).join(" ");
        document.getElementById("name").textContent = firstName;
        document.getElementById("anotherName").textContent = firstName;
        document.querySelector(".poster-names").textContent = name;
        document.querySelector(".usernames").textContent = "@" + username;

    }

    document.getElementById("create-post").addEventListener('click', ()=>{
    var fileInput = document.getElementById('postImage');
    var formData = new FormData();
    formData.append('id', id);
    formData.append('caption', document.getElementById('get-text').value);

    if (fileInput.files[0]) {
        formData.append('imagePost', fileInput.files[0]);
    }else{
        formData.append('imagePost', " ");
    }

    $.ajax({
        url: "php/post.php",
        type: "POST",
        data: formData,
        processData: false,
        contentType: false,
        success: function(data) {
            let result = JSON.parse(data);
            if (result.res === "success") {
                alert("Post added successfully.");
                window.location.reload();
            } else {
                alert(result.message);
            }
        },
        error: function() {
            alert("Error adding post.");
        }
    });
});


});

document.querySelector('.post').addEventListener('click', ()=>{
    document.querySelector('.add-post').style.display = 'block';
})
document.querySelector('#close').addEventListener('click', ()=>{
    document.querySelector('.add-post').style.display = 'none';
})
    </script>

</body>
</html>
